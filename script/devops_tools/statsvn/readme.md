使用方法

下载statsvn.jar

用SVN客户端取得SVN服务器上的最新版本代码，比如Linux上的命令如下：

#check out 最新版本
svn co http://xxxx.xxxxx.xxxxx/xxxxx
生成新版本的log日志：

#生成项目SVN日志
svn log -v --xml > 日志名XXX.log
在存放统计结果HTML的目录中，执行statsvn.jar，一个简单的例子：

#简单例子
java -jar ../statsvn.jar ../nova/日志名XXX.log ../nova  -charset utf-8 -disable-twitter-button -title Nova  -include **/*.cpp:**/*.h -exclude **/sqlite3/*.*
java -jar ../statsvn.jar               执行statsvn.jar，后面是它的参数

参数1：../nova/日志名XXX.log                调用上面生成的SVN日志

参数2：../nova             最新版本所在的目录

参数3：-charset utf-8         生成的HTML所用的字符集

参数4：-disable-twitter-button            关闭twitter连接，可能statsvn的开发者是一个twitter爱好者，statsvn默认在项目和开发人员的名字后加个twitter连接按钮，方便互动。这在中国行不通，大家都懂的...所以让twitter连接按钮不显示。

参数5：-title 标题名             这个设置在HTML页面中显示的项目标题

参数6：-include **/*.cpp:**/*.h        表示统计的文件类型，默认情况下statsvn统计指定目录下的所有文件（包括一些开发环境自动生成的文件等，这个参数可以设置指定统计具体文件，例子中的表示只统计项目目录下得CPP与H文件。

参数7：-exclude **/sqlite3/*.*         表示不统计的内容，例子中的参数表示不统计项目文件夹中sqlite3的内容(因为sqlite3的内容是调用别人写的程序，统计进去没有意义~）

这就是statsvn最常用的几个参数，其他更详细参数可以参考官方网站的介绍。

扩展使用方法

设置过滤规则：
'?'  匹配单个字符
'*'  匹配0个或多个字符
'**' 匹配0级或多级目录
例1：src/**/*.java-----
匹配src目录及子目录下所有java文件。*.java-----匹配根目录下的java文件，因为*不包含子目录。
例2：-include "**/*.c:**/*.h" -exclude "legacy/**"
匹配目录下除legacy目录下所有.c和.h文件。
注意：Unix系统下注意在表达式上使用引号，否则shell将会与通配符相冲突。


-cache-dir <directory>  
为从Subversion服务起收集信息指定缓存目录，

-username <subversion_username>  
指定连接Subversion server的用户名.

-password <subversion_username>  
指定连接Subversion server的密码.

-tags <tags-regularexpression>  
添加Subversion tags信息到报告中。只有与正则表达式相匹配的tags才会被添加。例如：-tags  '.*' 则会添加所有的tags。
注意：这一功能会到你的存储目录的/tags目录下查找tags，所以为了能让这一功能运行正常，必须在你的存储根目录下生成log文件，这样才会将各个tags和trunk的信息都写入log文件，但tags目录没有必要都checked out下来。
注意：Unix系统下注意在表达式上使用引号，否则shell将会与通配符相冲突。

-tags-dir <directory>  
指定tags正则表达式去评估的根目录，默认值为/tags/


-no-developer <login-name>  
在报告中排除某个或某几个开发者的代码提交信息。比如排除管理员的一些代码操作。

-verbose  
输出中添加进程信息

-bugzilla< bugzilla_install_root>  
指定Bugzilla的安装路径，报告中将以链接的形式代替'Bug ###'，这样方便直接链接至相应Bug。

-title <title>  
指定报告的名称，默认以Subversion模块名作为标题。

-xdoc  
将报告文档从默认的html文档改为Maven的XDoc文档。

-xml  
将报告文档从默认的html文档改为xml文档。

-css <stylesheet>  
为报告指定css样式，这里可以是http url或本地文件。

-notes <notes-file>  
指定一个注释文件，该文件的内容将会添加至报告的index页面。文件内容应该包含一个有效的块级html片段。例如：

<p>  
 These are development statistics for the<a href="http://www.statsvn.org" >StatSVN</a>  
project, created by StatSVN itself.  
</p>  
  
<p>  
<strong>Note:</strong>  
  
 This report was generated by an unreleased development version of StatSVN. It might contain features not yet found in the official release.  
  
</p>  
其它更多参数请查阅其官方文档。
示例：

java -jar statsvn.jar -verbose -title jUCMNav  -exclude **/src/urncore/**;**/src/grl/**;**/src/ucm/**;**/src/urn/**;**/src/seg/jUCMNav/model/ucm/**  \  -output-dir ./stats c:\eclipse\workspace\seg.jUCMNav\svn.log c:\eclipse\workspace\seg.jUCMNav  

5.  设置统计的开始与结束时间
虽然StatSVN不提供指定报告统计的开始与结束时间，但是可以通过svn log命令来指定从而达到相同的效果。

svn  log  v  -xml  -r  {2007-02-19}:{2007-02-12}> log.xml  
更多信息可以查看：
http://svnbook.red-bean.com/en/1.2/svn.tour.revs.html#svn.tour.revs.dates
http://jbrugge.com/blog/2007/02/27/using-date-ranges-with-statsvn/
6.  Ant任务
StatSVN可以与Apache Ant进行集成使用。
示例：
Xml代码  收藏代码
<?xml version="1.0"?>  
  
<project name="StatSvnAnt" default="main" basedir=".">  
  
  <taskdef name="statsvn" classname="net.sf.statsvn.ant.StatSvnTask" classpath="dist/statsvn.jar" />  
  
  
  <target name="main">  
  
    <statsvn  
  
        path="d:/statsvn"  
  
        log="d:/statsvn/logfile.log"  
  
        outputDir="d:/statsvn/stats"  
  
        title="StatSVN"  
  
        include="*/.java"  
  
        exclude="tests-src/**"  
  
        notes="d:/statsvn/report-notes.txt"/>  
  
  </target>  
</project>其中path和log属性是必须指定的（path为源码所在目录），其它属性可选。statsvn.jar必须位于Ant的classpath下，或者像上面一样由taskdef属性来指定。


由于StatSVN是静态的，需要执行一次才能查看新的结果，但是我们可以让他在系统中定时执行，比如每天晚上2:00执行一次，那么第二天就可以看到昨晚为止的所有统计情况。

以linux系统为例

我们可以把上述取得新版本，生成日志，生成统计的过程写成sh文件，并命名为"任务名.sh"

#!/bin/sh
cd ~
cd statsvn
svn co http://192.168.5.32/nova
cd nova
svn log -v --xml > svn.log
cd ..
cd novalog
java -jar ../statsvn.jar ../nova/svn.log ../nova  -charset utf-8 -disable-twitter-button -title Nova  -include **/*.cpp:**/*.h -exclude **/sqlite3/*.*
然后用crontab定时任务工具对这个sh进行定时执行（crontab的设置方法可以参考网上）

o@O:~$ crontab -l
# m h  dom mon dow   command
0 2 * * * /home/o/statsvn/任务名.sh
o@O:~$
把生成的html结果所在的目录软连接到apache的根目录（比如"www"文件夹下）就可以用过网页访问了。